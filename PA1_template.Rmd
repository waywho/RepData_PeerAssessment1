---
title: "Reproducible Research: Peer Assessment 1"
author: "WeiHsi Hu"
date: "19 October 2014"
output: html_document
keep_md: true
---

## Loading and preprocessing the data

```{r readfile}
activity <- read.csv("~/Documents/R/activity.csv")
activity$date <- as.Date(activity$date, format = "%Y-%m-%d")
activity$interval <- as.factor(activity$interval)
```

```{r summarise}
library(dplyr)

stepsSum <- activity %>%
        group_by(date) %>%
        summarise(stpSum = sum(steps))
```

## What is mean total number of steps taken per day?

Histogram of total number of steps taken each day

```{r histogram}
hist(stepsSum$stpSum, main = "Total Steps Each Day", xlab = "")
```


``` {r meanMedian}
stepsMean <- mean(activity$steps, na.rm = TRUE)
stepsMedian <- median(activity$steps, na.rm = TRUE)
```

The mean of the total number of steps take per day is `r stepsMean` steps and median total number of steps taken per da y is `r stepsMedian` steps.

## What is the average daily activity pattern?

A time series plot of the 5-minute interval and the average number of steps taken.
``` {r dailyAve}
stepsInt <- activity %>%
        group_by(interval) %>%
        summarise(
                meanSteps = mean(steps, na.rm = TRUE),
                medianSteps = median(steps, na.rm = TRUE))

with(stepsInt, plot(interval, meanSteps, ylab = "Average Number of Steps", 
                    xlab = "Intervals", type = "l"))
```

``` {r maxInt}
maxInt <- stepsInt[stepsInt$meanSteps == max(stepsInt$meanSteps), 1]
```

On average across all the days in the dataset, the maximum average steps took place at interval `r maxInt`.

## Inputing missing values

``` {r na}
sumNA <- sum(is.na(activity$steps))
```
 
There are in total `r sumNA` rows with NAs.

## Are there differences in activity patterns between weekdays and weekends?




